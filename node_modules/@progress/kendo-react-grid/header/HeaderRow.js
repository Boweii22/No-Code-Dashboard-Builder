/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright Â© 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const P=require("react"),j=require("../interfaces/GridSortSettings.js"),L=require("../drag/ColumnDraggable.js"),F=require("./GridHeaderCell.js"),f=require("@progress/kendo-react-common"),M=require("@progress/kendo-react-data-tools"),T=require("@progress/kendo-react-intl"),R=require("../messages/index.js"),E=require("@progress/kendo-svg-icons"),_=require("../utils/index.js");function V(e){const m=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e){for(const c in e)if(c!=="default"){const g=Object.getOwnPropertyDescriptor(e,c);Object.defineProperty(m,c,g.get?g:{enumerable:!0,get:()=>e[c]})}}return m.default=e,Object.freeze(m)}const r=V(P),W={true:{asc:"desc",desc:"","":"asc"},false:{asc:"desc",desc:"asc","":"asc"}},$={none:"none",asc:"ascending",desc:"descending"},B=e=>{const[m,c]=r.useState(),g=T.useLocalization(),b=r.useRef(null);let q=0,v=-1;const S=(l,n)=>{if(l.preventDefault(),!e.sortChange)return;const{allowUnsort:t,mode:s}=j.normalize(e.sortable||!1,n.sortable||!1),o=(e.sort||[]).filter(i=>i.field===n.field)[0],u=W[t][o&&o.dir||""],d=s==="single"?[]:(e.sort||[]).filter(i=>i.field!==n.field);u!==""&&n.field&&d.push({field:n.field,dir:u}),e.sortChange(d,l)},x=(l,n)=>{if(l.isDefaultPrevented())return;const{keyCode:t,metaKey:s,ctrlKey:o,altKey:u}=l,d=e.sortable&&n.sortable,i=l.target;if(d&&l.keyCode===f.Keys.enter&&i.className.indexOf("k-table-th")!==-1&&S(l,n),e.navigatable){if(e.groupable&&(s&&t===f.Keys.enter||o&&t===f.Keys.space)){l.preventDefault();const C=e.columns.findIndex(h=>h.field===n.field);e.columnGroupChange&&e.columnGroupChange(C,l)}u&&t===f.Keys.down&&(l.preventDefault(),c(n.field),b.current=i)}},I=()=>{c(void 0),b.current&&b.current.getAttribute("tabindex")!=="-1"&&b.current.focus()},K=l=>e.sort?l>=0&&[r.createElement("span",{key:1,className:"k-sort-icon"},r.createElement(f.IconWrap,{name:"sort-"+e.sort[l].dir+"-small",icon:e.sort[l].dir==="asc"?E.sortAscSmallIcon:E.sortDescSmallIcon})),e.sort.length>1&&r.createElement("span",{key:2,className:"k-sort-icon"},r.createElement("span",{className:"k-sort-order"},l+1))]:null,w=l=>l.map(n=>{const t=e.columns[n],s=e.sortable&&t.sortable,o=e.sort?e.sort.findIndex(a=>a.field===t.field):-1,u=o>=0&&e.sort[o].dir||"none",d=t.columnMenu===null?null:t.columnMenu||e.columnMenu,i=f.classNames({"k-first":t.kFirst,"k-filterable":!!d,"k-table-th":!0,"k-header":!0,"k-grid-header-sticky":t.locked,"k-sorted":e.sort&&e.sort.some(a=>a.field===t.field)},t.headerClassName);t.locked===!1&&(t.left=0);const C=t.left!==void 0?e.isRtl?{left:t.right,right:t.left}:{left:t.left,right:t.right}:{},h=g.toLanguageString(R.sortAriaLabel,R.messages[R.sortAriaLabel]),N=t.isAccessible?{ariaSort:$[u],role:"columnheader",ariaColumnIndex:t.ariaColumnIndex,ariaSelected:!1,ariaDescription:s?h:""}:{role:"presentation"},k=t.declarationIndex>=0?++v:--q,O=t.headerCell?t.headerCell:F.GridHeaderCell,D=r.createElement(O,{key:1,field:t.field,onClick:s&&(a=>S(a,t))||void 0,selectionChange:e.selectionChange,title:t.title,selectionValue:t.headerSelectionValue,render:e.cellRender,children:K(o),columnMenuWrapperProps:{column:{field:t.field,title:t.title,locked:t.locked,filter:t.filter,id:t.id},sortable:s&&e.sortable,sort:e.sort,onSortChange:e.sortChange,filter:e.filter,filterable:e.filterable&&t.filterable,filterOperators:e.filterOperators,onFilterChange:e.filterChange,show:m===t.field?!0:void 0,onCloseMenu:I,navigatable:e.navigatable,group:e.group,groupable:e.groupable,onGroupChange:e.groupChange,columnMenu:d}}),H={...N,key:k,colSpan:t.colSpan,rowSpan:t.rowSpan,className:i,style:C,columnId:t.id,navigatable:t.navigatable,onKeyDown:a=>x(a,t),role:"columnheader"},z=[D,e.columnResize&&e.columnResize.resizable&&t.resizable&&r.createElement(M.ColumnResizer,{key:2,resize:(a,A,G)=>e.columnResize&&e.columnResize.dragHandler(a,t,A,G),autofit:a=>e.columnResize&&e.columnResize.dblClickHandler(a,[t.id])})],y=_.resolveCells(e.cells,t.cells);if(y&&y.headerCell){const a=y.headerCell;return r.createElement(a,{...D.props,key:k,thProps:H,index:n},z)}return r.createElement(M.HeaderThElement,{...H,key:k},z)});return e.columnsMap.map((l,n)=>e.pressHandler&&r.createElement(L.ColumnDraggable,{key:n,pressHandler:e.pressHandler,dragHandler:e.dragHandler,releaseHandler:e.releaseHandler,ariaRowIndex:n+1,dragClue:e.dragClue,headerRef:e.headerRef,containerRef:e.containerRef},w(l))||r.createElement("tr",{key:n,className:"k-table-row",role:"row","aria-rowindex":n+1},w(l)))};exports.HeaderRow=B;
