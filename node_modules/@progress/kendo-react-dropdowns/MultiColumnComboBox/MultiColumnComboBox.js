/**
 * @license
 *-------------------------------------------------------------------------------------------
 * Copyright © 2024 Progress Software Corporation. All rights reserved.
 * Licensed under commercial license. See LICENSE.md in the package root for more information
 *-------------------------------------------------------------------------------------------
 */
"use client";"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const ne=require("react"),le=require("prop-types"),se=require("@progress/kendo-react-popup"),ue=require("../common/MultiColumnList.js"),u=require("@progress/kendo-react-common"),j=require("../ComboBox/ComboBox.js"),ie=require("../common/utils.js"),K=require("../common/withCustomComponent.js");function de(a){const i=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(a){for(const e in a)if(e!=="default"){const d=Object.getOwnPropertyDescriptor(a,e);Object.defineProperty(i,e,d.get?d:{enumerable:!0,get:()=>a[e]})}}return i.default=a,Object.freeze(i)}const t=de(ne),ce=(a,i)=>a?typeof a=="number"?a+"px":a:i,G=u.createPropsContext(),k=t.forwardRef((a,i)=>{const e=u.usePropsContext(G,a),d=t.useRef(null),n=t.useRef(null),w=u.getScrollbarWidth(),{columns:l=m.columns,popupSettings:f=m.popupSettings,className:W,size:me,prefix:z=void 0,suffix:L=void 0,onOpen:M,onClose:S,onFocus:E,onBlur:F,onChange:N,onFilterChange:R,onPageChange:H,..._}=e;t.useImperativeHandle(d,()=>({element:n.current&&n.current.element,focus(){n.current&&n.current.focus()},get value(){return n.current&&n.current.value},get name(){return n.current&&n.current.name},props:e})),t.useImperativeHandle(i,()=>d.current);const g=t.useMemo(()=>{if(e.groupField!==void 0&&e.data)return ie.getItemValue(e.data[0],e.groupField)},[e.data,e.groupField]),[v,C]=t.useState(g),[q,B]=t.useState(!0),[$]=z?K(e.prefix||t.Fragment):[],[D]=L?K(e.suffix||t.Fragment):[],V=t.useMemo(()=>{const o=t.createElement("th",{className:"k-table-th",colSpan:l.length},v);return t.createElement(t.Fragment,null,e.header,t.createElement("div",{className:"k-table-header-wrap"},t.createElement("table",{className:"k-table",role:"presentation"},t.createElement("colgroup",null,l.map((r,c)=>t.createElement("col",{key:r.uniqueKey?r.uniqueKey:c,style:{width:r.width?r.width:m.width}}))),t.createElement("thead",{className:"k-table-thead"},t.createElement("tr",{className:"k-table-row"},l.map((r,c)=>t.createElement("th",{className:"k-table-th",key:r.uniqueKey?r.uniqueKey:c},r.header||" "))),v&&q&&t.createElement("tr",{className:"k-table-group-row"},e.groupStickyHeaderItemRender?e.groupStickyHeaderItemRender.call(void 0,o,{}):o)))))},[e.header,l,v,q]),A=t.useMemo(()=>`calc(${l.map(o=>ce(o.width,m.width)).filter(Boolean).join(" + ")} + ${w}px + 4px)`,[l,w]),P=e.virtual?e.virtual.skip:0,J=t.useCallback((o,r)=>{const c=l.map((p,ae)=>t.createElement("span",{className:e.itemRender?void 0:"k-table-td",style:e.itemRender?void 0:{width:p.width?p.width:m.width},key:p.uniqueKey?p.uniqueKey:ae},p.field?String(u.getter(p.field)(r.dataItem)):""));let b,h,x,y,I=e.data||[];const O=r.index-P;e.groupField!==void 0&&(y=u.getter(e.groupField),h=y(I[O]),x=y(I[O-1]),h&&x&&h!==x&&(b=h)),b&&e.groupMode==="classic"&&c.push(t.createElement("div",{key:"group",className:"k-table-td k-table-group-td"},t.createElement("span",null,b)));const T=t.cloneElement(o,{...o.props,className:u.classNames("k-table-row",{"k-table-alt-row":r.index%2!==0,"k-focus":r.focused,"k-selected":r.selected,"k-first":!!b,"k-disabled":r.dataItem.disabled})},c);return e.itemRender?e.itemRender.call(void 0,T,r):T},[l,e.groupField,e.itemRender,e.data,P]),s=t.useCallback((o,r)=>{o&&o.call(void 0,{...r,target:d.current})},[]),Q=t.useCallback(o=>(e.virtual||C(g),s(M,o)),[s,M,e.virtual,g]),U=t.useCallback(o=>s(S,o),[S]),X=t.useCallback(o=>s(E,o),[E]),Y=t.useCallback(o=>s(F,o),[F]),Z=t.useCallback(o=>s(N,o),[N]),ee=t.useCallback(o=>s(H,o),[H]),te=t.useCallback(o=>(C(g),s(R,{...o,mobileMode:o.target.mobileMode})),[R]),oe=t.useCallback(o=>{C(o.group)},[]);t.useEffect(()=>{u.setScrollbarWidth()}),t.useEffect(()=>{const o=e.data;C(g),o&&o.length!==0?B(!0):B(!1)},[e.data]);const re=t.useCallback(o=>t.createElement(ue.MultiColumnList,{...o}),[]);return t.createElement(se.PopupPropsContext.Provider,{value:o=>({...o,popupClass:`k-dropdowngrid-popup ${f.popupClass}`})},t.createElement(j.ComboBox,{..._,list:re,popupSettings:{...f,width:f.width||A,className:f.className},ref:n,header:V,itemRender:J,groupHeaderItemRender:e.groupHeaderItemRender,size:e.size,rounded:e.rounded,fillMode:e.fillMode,groupMode:e.groupMode,groupField:e.groupField,isMultiColumn:!0,onOpen:Q,onClose:U,onFocus:X,onBlur:Y,onChange:Z,onFilterChange:te,onPageChange:ee,onGroupScroll:oe,className:u.classNames("k-dropdowngrid",W),required:e.required,adaptive:e.adaptive,adaptiveFilter:e.adaptiveFilter,adaptiveTitle:e.adaptiveTitle,footer:e.footer,footerClassName:"k-table-footer",prefix:$,suffix:D}))}),pe={...j.ComboBoxWithoutContext.propTypes,columns:le.any.isRequired},m={columns:[],popupSettings:{},width:"200px",size:"medium",rounded:"medium",fillMode:"solid"};k.displayName="KendoMultiColumnComboBox";k.propTypes=pe;k.defaultProps=m;exports.MultiColumnComboBox=k;exports.MultiColumnComboBoxPropsContext=G;
